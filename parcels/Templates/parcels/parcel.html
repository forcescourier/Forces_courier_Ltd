<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Parcels - Courier Management System</title>
    <!-- Favicon icon -->
    <link rel="icon" type="image/png" sizes="16x16" href="../../../assets/images/favicon.png">
    <link href="../../../vendor/jqvmap/css/jqvmap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../vendor/chartist/css/chartist.min.css">
    <link href="../../../vendor/bootstrap-select/dist/css/bootstrap-select.min.css" rel="stylesheet">
    <link href="../../../vendor/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css" rel="stylesheet">
    <link href="../../../assets/css/style.css" rel="stylesheet">
    <link href="../../../assets/css/custom-primary.css" rel="stylesheet">
    <link href="../../../assets/css/tables.css" rel="stylesheet">
    <link href="../../../assets/css/forms.css" rel="stylesheet">
    <link href="../../../assets/css/cards.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&amp;family=Roboto:wght@100;300;400;500;700;900&amp;display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <link href="../../../vendor/datatables/css/jquery.dataTables.min.css" rel="stylesheet">
    
    <!-- Parcels Page Specific Styles -->
    <style>
        /* Standardized Color Scheme - Green (#007A64) and Yellow (#FFD700) Only */
        .parcels-table thead th {
            background: #007A64 !important;
            color: #ffffff !important;
            font-weight: 600;
            border: none;
        }
        
        .parcels-table tbody tr:hover {
            background-color: rgba(0, 122, 100, 0.05) !important;
        }
        
        /* Standardized Badge Colors */
        .badge-warning { background-color: #FFD700 !important; color: #333 !important; }
        .badge-success { background-color: #007A64 !important; color: #ffffff !important; }
        .badge-primary { background-color: #007A64 !important; color: #ffffff !important; }
        .badge-info { background-color: #007A64 !important; color: #ffffff !important; }
        .badge-secondary { background-color: #FFD700 !important; color: #333 !important; }
        
        /* Standardized Button Colors */
        .btn-primary { background-color: #007A64 !important; border-color: #007A64 !important; }
        .btn-success { background-color: #007A64 !important; border-color: #007A64 !important; }
        .btn-info { background-color: #007A64 !important; border-color: #007A64 !important; }
        
        .btn-primary:hover, .btn-success:hover, .btn-info:hover {
            background-color: #005a4a !important; border-color: #005a4a !important;
        }
        
        /* Card Header Standard Color */
        .card-header {
            background: #007A64 !important;
            color: #ffffff !important;
            padding: 1.5rem 1.875rem;
        }
        
        /* Form Controls Standard Focus */
        .form-control:focus, .form-control-sm:focus {
            border-color: #007A64 !important;
            box-shadow: 0 0 0 0.2rem rgba(0, 122, 100, 0.25) !important;
        }
        
        /* Filter Form Styling */
        .filter-row {
            background: rgba(0, 122, 100, 0.05);
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .filter-row .form-control-sm {
            height: 40px;
            border: 2px solid #dee2e6;
            border-radius: 0.375rem;
        }
        
        .filter-row .btn-light {
            background: #007A64 !important;
            border-color: #007A64 !important;
            color: #ffffff !important;
            height: 40px;
        }
        
        .filter-row .btn-outline-light {
            background: transparent !important;
            border-color: #007A64 !important;
            color: #007A64 !important;
            height: 40px;
        }
        
        .filter-row .btn-light:hover {
            background: #005a4a !important;
            border-color: #005a4a !important;
        }
        
        .filter-row .btn-outline-light:hover {
            background: #007A64 !important;
            border-color: #007A64 !important;
            color: #ffffff !important;
        }
        
        /* Pagination Standard Colors */
        .dataTables_wrapper .dataTables_paginate .paginate_button {
            background: #007A64 !important;
            color: #ffffff !important;
            border: 1px solid #007A64 !important;
            margin: 0 0.125rem;
            padding: 0.5rem 0.75rem;
            border-radius: 0.375rem;
        }
        
        .dataTables_wrapper .dataTables_paginate .paginate_button:hover {
            background: #005a4a !important;
            border-color: #005a4a !important;
        }
        
        .dataTables_wrapper .dataTables_paginate .paginate_button.current {
            background: #FFD700 !important;
            color: #333 !important;
            border-color: #FFD700 !important;
            font-weight: 600;
        }
        
        .dataTables_wrapper .dataTables_paginate .paginate_button.disabled {
            background: #f8f9fa !important;
            color: #6c757d !important;
            border-color: #dee2e6 !important;
            opacity: 0.6;
        }
        
        /* Clean up checkbox styling */
        .custom-control-input:checked ~ .custom-control-label::before {
            background-color: #007A64 !important;
            border-color: #007A64 !important;
        }
        
        .custom-control-input:focus ~ .custom-control-label::before {
            box-shadow: 0 0 0 0.2rem rgba(0, 122, 100, 0.25) !important;
        }
        
        /* Info label styling */
        .info-label {
            font-weight: 600;
            color: #007A64 !important;
            display: inline-block;
            min-width: 60px;
        }
        
        /* Text primary color */
        .text-primary {
            color: #007A64 !important;
        }
        
        /* Ensure consistent button sizing */
        .btn-sm {
            padding: 0.25rem 0.75rem;
            font-size: 0.875rem;
            line-height: 1.5;
            border-radius: 0.375rem;
        }
        
        /* Bulk action styling */
        #bulkActionForm .btn {
            height: 32px;
            line-height: 1;
        }
        
        /* Dropdown menu styling */
        #statusMenu, #riderMenu {
            background: #ffffff;
            border: 1px solid #dee2e6;
            border-radius: 0.375rem;
            box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
        }
        
        #statusMenu .btn, #riderMenu .btn {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            color: #495057;
            text-align: left;
            width: 100%;
        }
        
        #statusMenu .btn:hover, #riderMenu .btn:hover {
            background: #007A64 !important;
            color: #ffffff !important;
            border-color: #007A64 !important;
        }
        
        /* Remove any conflicting styles */
        .dataTables_wrapper .dataTables_paginate .paginate_button::before,
        .dataTables_wrapper .dataTables_paginate .paginate_button::after {
            display: none !important;
        }
        
        /* Ensure proper table spacing */
        .parcels-table tbody tr td {
            padding: 1rem 1.25rem;
            vertical-align: middle;
        }
        
        /* Breadcrumb styling */
        .breadcrumb-item a {
            color: #007A64 !important;
        }
        
        .breadcrumb-item a:hover {
            color: #005a4a !important;
        }
        
        /* DataTables Controls Visibility and Styling - Side by Side Layout */
        .dataTables_wrapper .dataTables_length {
            margin: 1rem 1.25rem 0.5rem 1.25rem !important;
            font-size: 0.875rem !important;
            font-weight: 500 !important;
            color: #495057 !important;
            display: block !important;
            visibility: visible !important;
            white-space: nowrap !important;
            text-align: left !important;
        }
        
        .dataTables_wrapper .dataTables_length label {
            font-weight: 600 !important;
            color: #007A64 !important;
            display: inline-flex !important;
            align-items: center !important;
            gap: 0.5rem !important;
            white-space: nowrap !important;
            flex-wrap: nowrap !important;
        }
        
        /* DataTables Filter (Search) Styling - Side by Side Layout */
        .dataTables_wrapper .dataTables_filter {
            margin: 1rem 1.25rem 0.5rem 1.25rem !important;
            font-size: 0.875rem !important;
            font-weight: 500 !important;
            color: #495057 !important;
            display: block !important;
            visibility: visible !important;
            text-align: right !important;
        }
        
        .dataTables_wrapper .dataTables_filter label {
            font-weight: 600 !important;
            color: #007A64 !important;
            display: inline-flex !important;
            align-items: center !important;
            gap: 0.5rem !important;
            white-space: nowrap !important;
        }
        
        .dataTables_wrapper .dataTables_filter input {
            background: #ffffff !important;
            border: 2px solid #007A64 !important;
            border-radius: 0.375rem !important;
            padding: 0.375rem 0.75rem !important;
            margin-left: 0.5rem !important;
            color: #495057 !important;
            font-weight: 500 !important;
            font-size: 0.875rem !important;
            min-width: 200px !important;
            height: 38px !important;
            transition: all 0.3s ease !important;
        }
        
        .dataTables_wrapper .dataTables_filter input:focus {
            border-color: #007A64 !important;
            box-shadow: 0 0 0 0.2rem rgba(0, 122, 100, 0.25) !important;
            outline: none !important;
        }
        
        .dataTables_wrapper .dataTables_length select {
            background: #ffffff !important;
            border: 2px solid #007A64 !important;
            border-radius: 0.375rem !important;
            padding: 0.375rem 2rem 0.375rem 0.75rem !important;
            margin: 0 0.5rem !important;
            color: #495057 !important;
            font-weight: 600 !important;
            font-size: 0.875rem !important;
            min-width: 80px !important;
            height: 38px !important;
            line-height: 1.5 !important;
            cursor: pointer !important;
            box-shadow: 0 2px 4px rgba(0, 122, 100, 0.1) !important;
            transition: all 0.3s ease !important;
        }
        
        .dataTables_wrapper .dataTables_length select:focus {
            border-color: #007A64 !important;
            box-shadow: 0 0 0 0.2rem rgba(0, 122, 100, 0.25) !important;
            outline: none !important;
            background: #ffffff !important;
        }
        
        .dataTables_wrapper .dataTables_length select:hover {
            border-color: #005a4a !important;
            box-shadow: 0 2px 8px rgba(0, 122, 100, 0.15) !important;
        }
        
        .dataTables_wrapper .dataTables_info {
            margin: 1rem 1.25rem !important;
            font-size: 0.875rem !important;
            color: #6c757d !important;
            font-weight: 500 !important;
            padding: 0.5rem 0 !important;
        }
        
        /* Enhanced Filter Button Styling */
        .filter-row .btn-group {
            display: flex !important;
            width: 100% !important;
        }
        
        .filter-row .btn-group .btn {
            flex: 1 !important;
            height: 40px !important;
            font-weight: 600 !important;
            border-radius: 0.375rem !important;
            transition: all 0.3s ease !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            text-decoration: none !important;
        }
        
        .filter-row .btn-group .btn:first-child {
            margin-right: 0.25rem !important;
            border-top-right-radius: 0.375rem !important;
            border-bottom-right-radius: 0.375rem !important;
        }
        
        .filter-row .btn-group .btn:last-child {
            margin-left: 0.25rem !important;
            border-top-left-radius: 0.375rem !important;
            border-bottom-left-radius: 0.375rem !important;
        }
        
        .filter-row .btn-light {
            background: #007A64 !important;
            border: 2px solid #007A64 !important;
            color: #ffffff !important;
        }
        
        .filter-row .btn-light:hover {
            background: #005a4a !important;
            border-color: #005a4a !important;
            color: #ffffff !important;
            transform: translateY(-1px) !important;
            box-shadow: 0 4px 8px rgba(0, 122, 100, 0.25) !important;
        }
        
        .filter-row .btn-outline-light {
            background: #ffffff !important;
            border: 2px solid #007A64 !important;
            color: #007A64 !important;
        }
        
        .filter-row .btn-outline-light:hover {
            background: #007A64 !important;
            border-color: #007A64 !important;
            color: #ffffff !important;
            transform: translateY(-1px) !important;
            box-shadow: 0 4px 8px rgba(0, 122, 100, 0.25) !important;
        }
        
        .filter-row .btn i {
            font-size: 0.875rem !important;
            margin-right: 0.25rem !important;
        }
        
        /* Ensure proper table wrapper spacing */
        .dataTables_wrapper {
            margin-top: 0 !important;
            padding-top: 0 !important;
        }
        
        .dataTables_wrapper .row {
            margin: 0 !important;
        }
        
        .dataTables_wrapper .row > div {
            padding: 0 !important;
        }
        
        /* Make sure filter controls are properly spaced */
        .filter-row {
            background: rgba(0, 122, 100, 0.05) !important;
            padding: 1rem !important;
            border-radius: 0.5rem !important;
            margin-bottom: 0 !important;
            border: 1px solid rgba(0, 122, 100, 0.1) !important;
        }
        
        .filter-row .form-control-sm {
            height: 40px !important;
            border: 2px solid #dee2e6 !important;
            border-radius: 0.375rem !important;
            font-size: 0.875rem !important;
            font-weight: 500 !important;
            transition: all 0.3s ease !important;
        }
        
        .filter-row .form-control-sm:focus {
            border-color: #007A64 !important;
            box-shadow: 0 0 0 0.2rem rgba(0, 122, 100, 0.25) !important;
            background: #ffffff !important;
        }
        
        /* Visible contrast for select options */
        .filter-row select.form-control-sm {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%23007A64' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m6 8 4 4 4-4'/%3e%3c/svg%3e") !important;
            background-position: right 0.75rem center !important;
            background-repeat: no-repeat !important;
            background-size: 1rem 1rem !important;
            padding-right: 2.5rem !important;
        }
        
        /* Clear visual feedback for filter actions */
        .filter-row .btn:active {
            transform: translateY(0) !important;
            box-shadow: 0 2px 4px rgba(0, 122, 100, 0.2) !important;
        }
        
        /* Action Modal Styling */
        .modal-content {
            border-radius: 0.5rem !important;
            border: none !important;
            box-shadow: 0 1rem 3rem rgba(0, 0, 0, 0.175) !important;
        }
        
        .modal-header {
            border-bottom: 1px solid rgba(255, 255, 255, 0.2) !important;
            padding: 1.25rem 1.5rem !important;
        }
        
        .modal-body {
            padding: 1.5rem !important;
        }
        
        .modal-footer {
            padding: 1rem 1.5rem !important;
            border-top: 1px solid #dee2e6 !important;
        }
        
        #actionModal .form-control:focus {
            border-color: #007A64 !important;
            box-shadow: 0 0 0 0.2rem rgba(0, 122, 100, 0.25) !important;
        }
        
        #actionModal .form-group label {
            margin-bottom: 0.5rem !important;
            font-size: 0.9rem !important;
        }
        
        #actionModal .btn-primary {
            background: #007A64 !important;
            border-color: #007A64 !important;
            font-weight: 600 !important;
        }
        
        #actionModal .btn-primary:hover {
            background: #005a4a !important;
            border-color: #005a4a !important;
        }
        
        #actionModal .btn-outline-secondary {
            border-color: #6c757d !important;
            color: #6c757d !important;
            font-weight: 600 !important;
        }
        
        #actionModal .btn-outline-secondary:hover {
            background: #6c757d !important;
            border-color: #6c757d !important;
            color: #ffffff !important;
        }
        
        #actionModal select option {
            padding: 0.5rem !important;
        }
        
        #actionModal textarea {
            resize: vertical !important;
            min-height: 80px !important;
        }
    </style>
</head>

<body>

    <!--*******************
        Preloader start
    ********************-->
    <div id="preloader">
        <div class="sk-three-bounce">
            <div class="sk-child sk-bounce1"></div>
            <div class="sk-child sk-bounce2"></div>
            <div class="sk-child sk-bounce3"></div>
        </div>
    </div>
    <!--*******************
        Preloader end
    ********************-->

    <!--**********************************
        Main wrapper start
    ***********************************-->
    <div id="main-wrapper">

        <!--**********************************
            Nav header start
        ***********************************-->
        <div class="nav-header">
            <a href="../../../index.html" class="brand-logo">
                <img class="logo-abbr" src="../../../assets/images/logo.png" alt="">
                <img class="logo-compact" src="../../../assets/images/logo-text.png" alt="">
                <img class="brand-title" src="../../../assets/images/logo-text.png" alt="">
            </a>
            </a>

            <div class="nav-control">
                <div class="hamburger">
                    <span class="line"></span><span class="line"></span><span class="line"></span>
                </div>
            </div>
        </div>
        <!--**********************************
            Nav header end
        ***********************************-->

        <!--**********************************
            Header start
        ***********************************-->
        <div class="header">
            <div class="header-content">
                <nav class="navbar navbar-expand">
                    <div class="collapse navbar-collapse justify-content-between">
                        <div class="header-left">
                            <div class="dashboard_bar">
                                Dashboard
                            </div>
                        </div>
                        <ul class="navbar-nav header-right">
                            <li class="nav-item dropdown header-profile">
                                <a class="nav-link" href="#" role="button" data-toggle="dropdown">
                                    <img src="../../../assets/images/profile/1.jpg" width="20" alt="">
                                    <div class="header-info">
                                        <span class="text-black"><strong>Admin User</strong></span>
                                        <p class="mb-0 fs-12">Administrator</p>
                                    </div>
                                </a>
                                <div class="dropdown-menu dropdown-menu-right">
                                    <a href="../../../profile.html" class="dropdown-item ai-icon">
                                        <i class="flaticon-381-user"></i>
                                        <span class="ml-2">Profile</span>
                                    </a>
                                    <a href="../../authentication/logout.html" class="dropdown-item ai-icon">
                                        <i class="flaticon-381-exit"></i>
                                        <span class="ml-2">Logout</span>
                                    </a>
                                </div>
                            </li>
                        </ul>
                    </div>
                </nav>
            </div>
        </div>
        <!--**********************************
            Header end
        ***********************************-->

        <!--**********************************
            Sidebar start
        ***********************************-->
        <div class="deznav">
            <div class="deznav-scroll">
                <ul class="metismenu" id="menu">
                    <li><a href="dashboard" class="ai-icon" aria-expanded="false">
                            <i class="flaticon-381-networking"></i>
                            <span class="nav-text">Dashboard</span>
                        </a>
                    </li>
                    <li><a href="../parcels/parcels.html" class="ai-icon" aria-expanded="false">
                            <i class="flaticon-381-box"></i>
                            <span class="nav-text">Parcels</span>
                        </a>
                    </li>
                    <li><a href="../merchants/merchants.html" class="ai-icon" aria-expanded="false">
                            <i class="flaticon-381-user-7"></i>
                            <span class="nav-text">Merchants</span>
                        </a>
                    </li>
                    <li><a href="../riders/riders.html" class="ai-icon" aria-expanded="false">
                            <i class="flaticon-381-bike"></i>
                            <span class="nav-text">Riders</span>
                        </a>
                    </li>
                    <li><a href="../services/services.html" class="ai-icon" aria-expanded="false">
                            <i class="flaticon-381-list"></i>
                            <span class="nav-text">Services</span>
                        </a>
                    </li>
                    <li><a href="../areas/areas.html" class="ai-icon" aria-expanded="false">
                            <i class="flaticon-381-map"></i>
                            <span class="nav-text">Areas</span>
                        </a>
                    </li>
                    <li><a href="../payments/payments.html" class="ai-icon" aria-expanded="false">
                            <i class="flaticon-381-wallet"></i>
                            <span class="nav-text">Payments</span>
                        </a>
                    </li>
                    <li><a href="../invoices/invoices.html" class="ai-icon" aria-expanded="false">
                            <i class="flaticon-381-invoice"></i>
                            <span class="nav-text">Invoices</span>
                        </a>
                    </li>
                    <li><a href="../../reports/reports.html" class="ai-icon" aria-expanded="false">
                            <i class="flaticon-381-chart"></i>
                            <span class="nav-text">Reports</span>
                        </a>
                    </li>
                    <li><a href="../../../settings.html" class="ai-icon" aria-expanded="false">
                            <i class="flaticon-381-settings"></i>
                            <span class="nav-text">Settings</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        <!--**********************************
            Sidebar end
        ***********************************-->

        <!--**********************************
            Content body start
        ***********************************-->
        <div class="content-body">
            <div class="container-fluid">
                <div class="row page-titles mx-0">
                    <div class="col-sm-6 p-md-0">
                        <div class="welcome-text">
                            <span>Manage all parcels and track their status</span>
                        </div>
                    </div>
                    <div class="col-sm-6 p-md-0 justify-content-sm-end mt-2 mt-sm-0 d-flex">
                        <div class="d-flex align-items-center">
                            <!-- Action Navigation Buttons --> 
                            <!-- Breadcrumb -->
                            <ol class="breadcrumb mb-0">
                                <li class="breadcrumb-item"><a href="dashboard">Home</a></li>
                                <li class="breadcrumb-item active"><a href="">Parcels</a></li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons and Bulk Actions Section -->
                <div class="row mb-3">
                    <div class="col-md-6">
                        <!-- Action Buttons -->
                        <div class="btn-group">
                            <a href="add-parcel.html" class="btn btn-primary btn-sm" title="Add New Parcel">
                                <i class="fas fa-plus"></i> Add New Parcel
                            </a>
                            <a href="bulk-import.html" class="btn btn-outline-secondary btn-sm" title="Bulk Import">
                                <i class="fas fa-upload"></i> Bulk Import
                            </a>
                            <a href="export-parcels.html" class="btn btn-outline-secondary btn-sm" title="Export Data">
                                <i class="fas fa-download"></i> Export Data
                            </a>
                            <a href="track-parcel.html" class="btn btn-outline-secondary btn-sm" title="Track Parcel">
                                <i class="fas fa-search-location"></i> Track Parcel
                            </a>
                            <button class="btn btn-outline-secondary btn-sm" onclick="refreshTable()" title="Refresh">
                                <i class="fas fa-sync-alt"></i> Refresh
                            </button>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <!-- Bulk Actions Section -->
                        <div class="d-flex justify-content-end align-items-center" style="position: relative;">
                            <div class="btn-group" id="bulkActionForm">
                                <button type="button" class="btn btn-outline-secondary btn-sm" onclick="toggleStatusMenu()" id="statusBtn">
                                    <i class="fas fa-tasks"></i> Select Status
                                </button>
                                <button type="button" class="btn btn-outline-secondary btn-sm" onclick="toggleRiderMenu()" id="riderBtn">
                                    <i class="fas fa-user"></i> Select Rider
                                </button>
                                <button type="button" class="btn btn-success btn-sm" onclick="submitBulkSelection()">
                                    <i class="fas fa-check"></i> Submit
                                </button>
                            </div>
                            
                            <!-- Status Selection Menu -->
                            <div id="statusMenu" style="display: none; position: absolute; top: 100%; right: 250px; z-index: 1060; background: white; border: 1px solid #ddd; border-radius: 4px; padding: 8px; min-width: 180px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                                <div style="font-weight: bold; margin-bottom: 5px; color: #007A64;">Select Status:</div>
                                <button type="button" class="btn btn-light btn-sm btn-block mb-1" onclick="selectStatus('pending')" style="text-align: left;">‚è≥ Pending</button>
                                <button type="button" class="btn btn-light btn-sm btn-block mb-1" onclick="selectStatus('pickup')" style="text-align: left;">üì¶ Pickup Assigned</button>
                                <button type="button" class="btn btn-light btn-sm btn-block mb-1" onclick="selectStatus('transit')" style="text-align: left;">üöö In Transit</button>
                                <button type="button" class="btn btn-light btn-sm btn-block mb-1" onclick="selectStatus('delivery')" style="text-align: left;">üöõ Out for Delivery</button>
                                <button type="button" class="btn btn-light btn-sm btn-block mb-1" onclick="selectStatus('delivered')" style="text-align: left;">‚úÖ Delivered</button>
                                <button type="button" class="btn btn-light btn-sm btn-block" onclick="selectStatus('returned')" style="text-align: left;">‚Ü©Ô∏è Returned</button>
                            </div>
                            
                            <!-- Rider Selection Menu -->
                            <div id="riderMenu" style="display: none; position: absolute; top: 100%; right: 100px; z-index: 1060; background: white; border: 1px solid #ddd; border-radius: 4px; padding: 8px; min-width: 180px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                                <div style="font-weight: bold; margin-bottom: 5px; color: #007A64;">Select Rider:</div>
                                <button type="button" class="btn btn-light btn-sm btn-block mb-1" onclick="selectRider('rider1')" style="text-align: left;">üë§ Ahmed Rahman</button>
                                <button type="button" class="btn btn-light btn-sm btn-block mb-1" onclick="selectRider('rider2')" style="text-align: left;">üë§ Karim Uddin</button>
                                <button type="button" class="btn btn-light btn-sm btn-block mb-1" onclick="selectRider('rider3')" style="text-align: left;">üë§ Nasir Mahmud</button>
                                <button type="button" class="btn btn-light btn-sm btn-block mb-1" onclick="selectRider('rider4')" style="text-align: left;">üë§ Salma Begum</button>
                                <button type="button" class="btn btn-light btn-sm btn-block" onclick="selectRider('rider5')" style="text-align: left;">üë§ Fahim Hassan</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Comprehensive Parcels Management -->
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <!-- Simplified Filter Section -->
                                <div class="filter-row">
                                    <div class="row align-items-center" id="filterForm">
                                        <div class="col-md-3">
                                            <input type="text" class="form-control form-control-sm" id="searchFilter" 
                                                   placeholder="üîç Search parcels, names, phones...">
                                        </div>
                                        <div class="col-md-2">
                                            <select class="form-control form-control-sm" id="statusFilter">
                                                <option value="">üìã All Status</option>
                                                <option value="pending">‚è≥ Pending</option>
                                                <option value="pickup">üì¶ Pickup Assigned</option>
                                                <option value="transit">üöö In Transit</option>
                                                <option value="delivery">üöõ Out for Delivery</option>
                                                <option value="delivered">‚úÖ Delivered</option>
                                                <option value="returned">‚Ü©Ô∏è Returned</option>
                                            </select>
                                        </div>
                                        <div class="col-md-2">
                                            <select class="form-control form-control-sm" id="areaFilter">
                                                <option value="">üó∫Ô∏è All Areas</option>
                                                <option value="dhaka">üìç Dhaka</option>
                                                <option value="chittagong">üìç Chittagong</option>
                                                <option value="sylhet">üìç Sylhet</option>
                                                <option value="rajshahi">üìç Rajshahi</option>
                                                <option value="barisal">üìç Barisal</option>
                                                <option value="cumilla">üìç Cumilla</option>
                                            </select>
                                        </div>
                                        <div class="col-md-2">
                                            <input type="date" class="form-control form-control-sm" id="dateFromFilter" placeholder="üìÖ From Date">
                                        </div>
                                        <div class="col-md-2">
                                            <input type="date" class="form-control form-control-sm" id="dateToFilter" placeholder="üìÖ To Date">
                                        </div>
                                        <div class="col-md-1">
                                            <div class="btn-group w-100">
                                                <button type="button" class="btn btn-light btn-sm" onclick="applyFilters()" title="Apply Filters">
                                                    <i class="fas fa-filter"></i>
                                                </button>
                                                <button type="button" class="btn btn-outline-light btn-sm" onclick="clearFilters()" title="Clear All">
                                                    <i class="fas fa-times"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table id="parcelsTable" class="table table-striped parcels-table mb-0">
                                        <thead class="thead-primary">
                                            <tr>
                                                <th style="width: 3%;">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input" id="selectAll" onchange="toggleSelectAll()">
                                                        <label class="custom-control-label" for="selectAll"></label>
                                                    </div>
                                                </th>
                                                <th style="width: 12%;">Parcel Details</th>
                                                <th style="width: 22%;">Sender Details</th>
                                                <th style="width: 22%;">Receiver Details</th>
                                                <th style="width: 24%;">Payment & Details</th>
                                                <th style="width: 13%;">Notes</th>
                                                <th style="width: 4%;">Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input parcel-checkbox" id="parcel1" value="PKG001">
                                                        <label class="custom-control-label" for="parcel1"></label>
                                                    </div>
                                                </td>
                                                <td class="parcel-details-info">
                                                    <div class="mb-1"><strong class="font-weight-bold text-primary">{{parcels_id}}</strong></div>
                                                    <div class="mb-1"><span class="text-muted">MI: INV-2024-001</span></div>
                                                    <div><span class="text-muted">Date:</span> <small class="text-muted">2024-01-15 10:30 AM</small></div>
                                                </td>
                                                <td class="sender-receiver-info">
                                                    <div class="mb-1"><span class="info-label">Name:</span>Jally </div>
                                                    <div class="mb-1"><span class="info-label">Phone:</span>6939892 </div>
                                                    <div><span class="info-label">Address:</span> House 45, Road 12<br></div>
                                                </td>
                                                <td class="sender-receiver-info">
                                                    <div class="mb-1"><span class="info-label">Name:</span> {{parcels_customer_name}}</div>
                                                    <div class="mb-1"><span class="info-label">Phone:</span>{{parcels_customer_phone}}</div>
                                                    <div><span class="info-label">Address:</span> Plot 78, Block C<br>{{parcels_customer_address}}</div>
                                                </td>
                                                <td class="amount-info">
                                                    <div class="mb-0"><span class="info-label">Weight:</span> <strong>2.5 kg</strong></div>
                                                    <div class="mb-0"><span class="info-label">Area:</span> Dhaka</div>
                                                    <div class="mb-0"><span class="info-label">Charge:</span> ‡ß≥150</div>
                                                    <div class="mb-0"><span class="info-label">COD:</span> ‡ß≥2,500</div>
                                                    <div class="mb-1"><span class="info-label">Payable:</span> <span class="text-success font-weight-bold">‡ß≥2,350</span></div>
                                                    <div><span class="badge badge-warning">‚è≥ Pending</span></div>
                                                </td>
                                                <td class="sender-receiver-info">Electronics - Laptop. Handle with care. Fragile item.</td>
                                                <td class="text-center">
                                                    <div class="btn-group">
                                                        <a href="view-parcel.html?id=PKG001" class="btn btn-primary btn-sm" title="View Details">
                                                            <i class="fas fa-eye"></i>
                                                        </a>
                                                        <button class="btn btn-success btn-sm" title="Actions" onclick="openActionModal('PKG001')">
                                                            <i class="fas fa-cog"></i>
                                                        </button>
                                                        <a href="edit-parcel.html?id=PKG001" class="btn btn-info btn-sm" title="Edit">
                                                            <i class="fas fa-edit"></i>
                                                        </a>
                                                    </div>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input parcel-checkbox" id="parcel2" value="PKG002">
                                                        <label class="custom-control-label" for="parcel2"></label>
                                                    </div>
                                                </td>
                                                <td class="parcel-details-info">
                                                    <div class="mb-1"><strong class="font-weight-bold text-primary">#PKG002</strong></div>
                                                    <div class="mb-1"><span class="text-muted">MI: INV-2024-002</span></div>
                                                    <div><span class="text-muted">Date:</span> <small class="text-muted">2024-01-15 02:15 PM</small></div>
                                                </td>
                                                <td class="sender-receiver-info">
                                                    <div class="mb-1"><span class="info-label">Name:</span> Rahman Ahmed</div>
                                                    <div class="mb-1"><span class="info-label">Phone:</span> +880 1812345678</div>
                                                    <div><span class="info-label">Address:</span> 25/A New Market<br>Chittagong-4000</div>
                                                </td>
                                                <td class="sender-receiver-info">
                                                    <div class="mb-1"><span class="info-label">Name:</span> Fatima Khatun</div>
                                                    <div class="mb-1"><span class="info-label">Phone:</span> +880 1556789012</div>
                                                    <div><span class="info-label">Address:</span> Village: Rampur<br>Cumilla-3500</div>
                                                </td>
                                                <td class="amount-info">
                                                    <div class="mb-0"><span class="info-label">Weight:</span> <strong>1.2 kg</strong></div>
                                                    <div class="mb-0"><span class="info-label">Area:</span> Cumilla</div>
                                                    <div class="mb-0"><span class="info-label">Charge:</span> ‡ß≥120</div>
                                                    <div class="mb-0"><span class="info-label">COD:</span> ‡ß≥0</div>
                                                    <div class="mb-1"><span class="info-label">Payable:</span> <span class="text-success font-weight-bold">‡ß≥0</span></div>
                                                    <div><span class="badge badge-success">‚úÖ Delivered</span></div>
                                                </td>
                                                <td class="sender-receiver-info">Books and documents. Standard delivery completed.</td>
                                                <td class="text-center">
                                                    <div class="btn-group">
                                                        <a href="view-parcel.html?id=PKG002" class="btn btn-primary btn-sm" title="View Details">
                                                            <i class="fas fa-eye"></i>
                                                        </a>
                                                        <button class="btn btn-success btn-sm" title="Actions" onclick="openActionModal('PKG002')">
                                                            <i class="fas fa-cog"></i>
                                                        </button>
                                                        <a href="edit-parcel.html?id=PKG002" class="btn btn-info btn-sm" title="Edit">
                                                            <i class="fas fa-edit"></i>
                                                        </a>
                                                    </div>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input parcel-checkbox" id="parcel3" value="PKG003">
                                                        <label class="custom-control-label" for="parcel3"></label>
                                                    </div>
                                                </td>
                                                <td class="parcel-details-info">
                                                    <div class="mb-1"><strong class="font-weight-bold text-primary">#PKG003</strong></div>
                                                    <div class="mb-1"><span class="text-muted">MI: INV-2024-003</span></div>
                                                    <div><span class="text-muted">Date:</span> <small class="text-muted">2024-01-16 09:45 AM</small></div>
                                                </td>
                                                <td class="sender-receiver-info">
                                                    <div class="mb-1"><span class="info-label">Name:</span> Karim Uddin</div>
                                                    <div class="mb-1"><span class="info-label">Phone:</span> +880 1912345678</div>
                                                    <div><span class="info-label">Address:</span> Shop 15, Bondor Bazar<br>Sylhet-3100</div>
                                                </td>
                                                <td class="sender-receiver-info">
                                                    <div class="mb-1"><span class="info-label">Name:</span> Nasir Mahmud</div>
                                                    <div class="mb-1"><span class="info-label">Phone:</span> +880 1745612389</div>
                                                    <div><span class="info-label">Address:</span> House 88, Sector 7<br>Uttara, Dhaka-1230</div>
                                                </td>
                                                <td class="amount-info">
                                                    <div class="mb-0"><span class="info-label">Weight:</span> <strong>3.8 kg</strong></div>
                                                    <div class="mb-0"><span class="info-label">Area:</span> Dhaka</div>
                                                    <div class="mb-0"><span class="info-label">Charge:</span> ‡ß≥200</div>
                                                    <div class="mb-0"><span class="info-label">COD:</span> ‡ß≥5,800</div>
                                                    <div class="mb-1"><span class="info-label">Payable:</span> <span class="text-success font-weight-bold">‡ß≥5,600</span></div>
                                                    <div><span class="badge badge-primary">üöõ Out for Delivery</span></div>
                                                </td>
                                                <td class="sender-receiver-info">Mobile accessories. Call before delivery. Preferred time: Evening.</td>
                                                <td class="text-center">
                                                    <div class="btn-group">
                                                        <a href="view-parcel.html?id=PKG003" class="btn btn-primary btn-sm" title="View Details">
                                                            <i class="fas fa-eye"></i>
                                                        </a>
                                                        <button class="btn btn-success btn-sm" title="Actions" onclick="openActionModal('PKG003')">
                                                            <i class="fas fa-cog"></i>
                                                        </button>
                                                        <a href="edit-parcel.html?id=PKG003" class="btn btn-info btn-sm" title="Edit">
                                                            <i class="fas fa-edit"></i>
                                                        </a>
                                                    </div>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input parcel-checkbox" id="parcel4" value="PKG004">
                                                        <label class="custom-control-label" for="parcel4"></label>
                                                    </div>
                                                </td>
                                                <td class="parcel-details-info">
                                                    <div class="mb-1"><strong class="font-weight-bold text-primary">#PKG004</strong></div>
                                                    <div class="mb-1"><span class="text-muted">MI: INV-2024-004</span></div>
                                                    <div><span class="text-muted">Date:</span> <small class="text-muted">2024-01-16 11:20 AM</small></div>
                                                </td>
                                                <td class="sender-receiver-info">
                                                    <div class="mb-1"><span class="info-label">Name:</span> Salma Begum</div>
                                                    <div class="mb-1"><span class="info-label">Phone:</span> +880 1634567890</div>
                                                    <div><span class="info-label">Address:</span> Road 27, House 12<br>Gulshan-2, Dhaka-1212</div>
                                                </td>
                                                <td class="sender-receiver-info">
                                                    <div class="mb-1"><span class="info-label">Name:</span> Ruma Akter</div>
                                                    <div class="mb-1"><span class="info-label">Phone:</span> +880 1823456789</div>
                                                    <div><span class="info-label">Address:</span> 142 New Market Road<br>Barisal-8200</div>
                                                </td>
                                                <td class="amount-info">
                                                    <div class="mb-0"><span class="info-label">Weight:</span> <strong>0.8 kg</strong></div>
                                                    <div class="mb-0"><span class="info-label">Area:</span> Barisal</div>
                                                    <div class="mb-0"><span class="info-label">Charge:</span> ‡ß≥180</div>
                                                    <div class="mb-0"><span class="info-label">COD:</span> ‡ß≥1,200</div>
                                                    <div class="mb-1"><span class="info-label">Payable:</span> <span class="text-success font-weight-bold">‡ß≥1,020</span></div>
                                                    <div><span class="badge badge-info">üöö In Transit</span></div>
                                                </td>
                                                <td class="sender-receiver-info">Clothing items. Express delivery requested. Gift wrapping included.</td>
                                                <td class="text-center">
                                                    <div class="btn-group">
                                                        <a href="view-parcel.html?id=PKG004" class="btn btn-primary btn-sm" title="View Details">
                                                            <i class="fas fa-eye"></i>
                                                        </a>
                                                        <button class="btn btn-success btn-sm" title="Actions" onclick="openActionModal('PKG004')">
                                                            <i class="fas fa-cog"></i>
                                                        </button>
                                                        <a href="edit-parcel.html?id=PKG004" class="btn btn-info btn-sm" title="Edit">
                                                            <i class="fas fa-edit"></i>
                                                        </a>
                                                    </div>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input parcel-checkbox" id="parcel5" value="PKG005">
                                                        <label class="custom-control-label" for="parcel5"></label>
                                                    </div>
                                                </td>
                                                <td class="parcel-details-info">
                                                    <div class="mb-1"><strong class="font-weight-bold text-primary">#PKG005</strong></div>
                                                    <div class="mb-1"><span class="text-muted">MI: INV-2024-005</span></div>
                                                    <div><span class="text-muted">Date:</span> <small class="text-muted">2024-01-16 03:45 PM</small></div>
                                                </td>
                                                <td class="sender-receiver-info">
                                                    <div class="mb-1"><span class="info-label">Name:</span> Mohammad Hasan</div>
                                                    <div class="mb-1"><span class="info-label">Phone:</span> +880 1567890123</div>
                                                    <div><span class="info-label">Address:</span> Station Road, Uposhohor<br>Rajshahi-6000</div>
                                                </td>
                                                <td class="sender-receiver-info">
                                                    <div class="mb-1"><span class="info-label">Name:</span> Ayesha Siddika</div>
                                                    <div class="mb-1"><span class="info-label">Phone:</span> +880 1445667788</div>
                                                    <div><span class="info-label">Address:</span> Green Road, Panthapath<br>Dhaka-1215</div>
                                                </td>
                                                <td class="amount-info">
                                                    <div class="mb-0"><span class="info-label">Weight:</span> <strong>5.2 kg</strong></div>
                                                    <div class="mb-0"><span class="info-label">Area:</span> Dhaka</div>
                                                    <div class="mb-0"><span class="info-label">Charge:</span> ‡ß≥250</div>
                                                    <div class="mb-0"><span class="info-label">COD:</span> ‡ß≥8,500</div>
                                                    <div class="mb-1"><span class="info-label">Payable:</span> <span class="text-success font-weight-bold">‡ß≥8,250</span></div>
                                                    <div><span class="badge badge-secondary">üì¶ Pickup Assigned</span></div>
                                                </td>
                                                <td class="sender-receiver-info">Home appliances. Heavy item. Requires two persons for delivery.</td>
                                                <td class="text-center">
                                                    <div class="btn-group">
                                                        <a href="view-parcel.html?id=PKG005" class="btn btn-primary btn-sm" title="View Details">
                                                            <i class="fas fa-eye"></i>
                                                        </a>
                                                        <button class="btn btn-success btn-sm" title="Actions" onclick="openActionModal('PKG005')">
                                                            <i class="fas fa-cog"></i>
                                                        </button>
                                                        <a href="edit-parcel.html?id=PKG005" class="btn btn-info btn-sm" title="Edit">
                                                            <i class="fas fa-edit"></i>
                                                        </a>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--**********************************
            Content body end
        ***********************************-->

        <!--**********************************
            Footer start
        ***********************************-->
        <div class="footer">
            <div class="copyright">
                <p>Copyright ¬© 2024 Courier Management System. All rights reserved.</p>
            </div>
        </div>
        <!--**********************************
            Footer end
        ***********************************-->
    </div>
    <!--**********************************
        Main wrapper end
    ***********************************-->

    <!-- Action Modal -->
    <div class="modal fade" id="actionModal" tabindex="-1" role="dialog" aria-labelledby="actionModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-md" role="document">
            <div class="modal-content">
                <div class="modal-header" style="background: #007A64; color: #ffffff;">
                    <h5 class="modal-title" id="actionModalLabel">
                        <i class="fas fa-cog mr-2"></i>Parcel Actions
                    </h5>
                    <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="actionForm">
                        <input type="hidden" id="actionParcelId" name="parcelId">
                        
                        <!-- Reason Input -->
                        <div class="form-group">
                            <label for="actionReason" class="font-weight-bold text-primary">
                                <i class="fas fa-comment-alt mr-1"></i>Reason
                            </label>
                            <textarea class="form-control" id="actionReason" name="reason" rows="3" 
                                      placeholder="Enter reason for status change or rider assignment..." 
                                      style="border: 2px solid #007A64; border-radius: 0.375rem;"></textarea>
                        </div>
                        
                        <!-- Status Select -->
                        <div class="form-group">
                            <label for="actionStatus" class="font-weight-bold text-primary">
                                <i class="fas fa-tasks mr-1"></i>Select Status
                            </label>
                            <select class="form-control" id="actionStatus" name="status" 
                                    style="border: 2px solid #007A64; border-radius: 0.375rem; height: 40px;">
                                <option value="">-- Select New Status --</option>
                                <option value="pending">‚è≥ Pending</option>
                                <option value="pickup">üì¶ Pickup Assigned</option>
                                <option value="transit">üöö In Transit</option>
                                <option value="delivery">üöõ Out for Delivery</option>
                                <option value="delivered">‚úÖ Delivered</option>
                                <option value="returned">‚Ü©Ô∏è Returned</option>
                            </select>
                        </div>
                        
                        <!-- Rider Select -->
                        <div class="form-group">
                            <label for="actionRider" class="font-weight-bold text-primary">
                                <i class="fas fa-user mr-1"></i>Select Rider
                            </label>
                            <select class="form-control" id="actionRider" name="rider" 
                                    style="border: 2px solid #007A64; border-radius: 0.375rem; height: 40px;">
                                <option value="">-- Select Rider --</option>
                                <option value="rider1">üë§ Ahmed Rahman</option>
                                <option value="rider2">üë§ Karim Uddin</option>
                                <option value="rider3">üë§ Nasir Mahmud</option>
                                <option value="rider4">üë§ Salma Begum</option>
                                <option value="rider5">üë§ Fahim Hassan</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer" style="background: #f8f9fa; border-top: 1px solid #dee2e6;">
                    <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">
                        <i class="fas fa-times mr-1"></i>Cancel
                    </button>
                    <button type="button" class="btn btn-primary" onclick="submitParcelAction()" 
                            style="background: #007A64; border-color: #007A64;">
                        <i class="fas fa-check mr-1"></i>Submit
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!--**********************************
        Scripts
    ***********************************-->
    <script src="../../../vendor/global/global.min.js"></script>
    <script src="../../../vendor/bootstrap-select/dist/js/bootstrap-select.min.js"></script>
    <script src="../../../vendor/datatables/js/jquery.dataTables.min.js"></script>
    <script src="../../../assets/js/custom.min.js"></script>
    <script src="../../../assets/js/deznav-init.js"></script>
    <script src="../../../assets/js/common.js"></script>
    <script src="../../../assets/js/tables.js"></script>

    <script>
        // Initialize parcels page functionality
        $(document).ready(function() {
            // Initialize parcels table with enhanced configuration
            var tableInstance = $('#parcelsTable').DataTable({
                pageLength: 15,
                lengthMenu: [[10, 15, 25, 50, 100], [10, 15, 25, 50, 100]],
                dom: '<"row"<"col-md-6"l><"col-md-6"f>>t<"row"<"col-md-6"i><"col-md-6"p>>',
                responsive: true,
                columnDefs: [
                    { targets: [0], orderable: false, className: 'text-center' }, // Checkbox column
                    { targets: [-1], orderable: false, className: 'text-center' } // Actions column
                ],
                order: [[1, 'desc']], // Default sort by parcel details
                language: {
                    lengthMenu: "Show _MENU_ entries",
                    info: "Showing _START_ to _END_ of _TOTAL_ parcels",
                    search: "Search:",
                    paginate: {
                        first: "First",
                        last: "Last",
                        next: "Next",
                        previous: "Previous"
                    }
                },
                drawCallback: function() {
                    // Ensure tooltips are initialized after table draw
                    $('[data-toggle="tooltip"]').tooltip();
                    
                    // Update bulk selection state
                    CourierApp.updateBulkActionState('#parcelsTable', '.parcel-checkbox');
                }
            });
            
            // Initialize filters with the table instance
            CourierApp.Tables.initParcelFilters(tableInstance);
            
            // Initialize bulk actions
            CourierApp.Tables.initBulkActions();
            
            // Initialize row actions
            CourierApp.Tables.initRowActions();
            
            // Initialize quick search
            CourierApp.Tables.initQuickSearch(tableInstance);
            
            // Initialize bulk selection functionality
            CourierApp.initBulkSelection('#parcelsTable', '.parcel-checkbox');
            
            // Initialize tooltips
            CourierApp.initTooltips();
            
            // Ensure DataTables controls are visible
            setTimeout(function() {
                $('.dataTables_length').show().css({
                    'display': 'block',
                    'visibility': 'visible',
                    'opacity': '1'
                });
                
                $('.dataTables_filter').show().css({
                    'display': 'block',
                    'visibility': 'visible',
                    'opacity': '1'
                });
                
                $('.dataTables_info').show().css({
                    'display': 'block',
                    'visibility': 'visible',
                    'opacity': '1'
                });
                
                $('.dataTables_paginate').show().css({
                    'display': 'block',
                    'visibility': 'visible',
                    'opacity': '1'
                });
                
                // Add enhanced styling to controls
                $('.dataTables_length select').addClass('form-control-enhanced');
                $('.dataTables_filter input').addClass('form-control-enhanced');
            }, 100);
            
            // Bind functions to global scope for inline onclick handlers
            window.refreshTable = function() {
                // Clear all filters and refresh table
                CourierApp.Tables.clearFilters(tableInstance);
                CourierApp.showToast('Table refreshed successfully', 'success');
            };
            
            window.applyFilters = function() {
                CourierApp.Tables.applyFilters(tableInstance);
            };
            
            window.clearFilters = function() {
                CourierApp.Tables.clearFilters(tableInstance);
            };
            
            window.toggleSelectAll = function() {
                CourierApp.toggleSelectAll('#parcelsTable', '.parcel-checkbox');
            };
            
            // Bulk action functions
            window.toggleStatusMenu = function() {
                CourierApp.toggleDropdownMenu('statusMenu', 'riderMenu');
            };
            
            window.toggleRiderMenu = function() {
                CourierApp.toggleDropdownMenu('riderMenu', 'statusMenu');
            };
            
            window.selectStatus = function(status) {
                CourierApp.selectBulkStatus(status, 'statusBtn');
            };
            
            window.selectRider = function(rider) {
                CourierApp.selectBulkRider(rider, 'riderBtn');
            };
            
            window.submitBulkSelection = function() {
                CourierApp.submitBulkAction('.parcel-checkbox:checked');
            };
            
            // Action Modal Functions
            window.openActionModal = function(parcelId) {
                // Set the parcel ID in the hidden input
                $('#actionParcelId').val(parcelId);
                
                // Reset form
                $('#actionForm')[0].reset();
                $('#actionParcelId').val(parcelId); // Restore parcel ID after reset
                
                // Update modal title with parcel ID
                $('#actionModalLabel').html('<i class="fas fa-cog mr-2"></i>Parcel Actions - ' + parcelId);
                
                // Show the modal
                $('#actionModal').modal('show');
            };
            
            window.submitParcelAction = function() {
                var parcelId = $('#actionParcelId').val();
                var reason = $('#actionReason').val();
                var status = $('#actionStatus').val();
                var rider = $('#actionRider').val();
                
                // Validation
                if (!reason.trim()) {
                    CourierApp.showToast('Please enter a reason for this action', 'warning');
                    return;
                }
                
                if (!status && !rider) {
                    CourierApp.showToast('Please select either a status or rider to update', 'warning');
                    return;
                }
                
                // Create action summary
                var actionSummary = 'Parcel ' + parcelId + ' updated:';
                var actions = [];
                
                if (status) {
                    var statusText = $('#actionStatus option:selected').text();
                    actions.push('Status: ' + statusText);
                }
                
                if (rider) {
                    var riderText = $('#actionRider option:selected').text();
                    actions.push('Rider: ' + riderText);
                }
                
                actions.push('Reason: ' + reason);
                
                // Simulate API call (replace with actual API call)
                setTimeout(function() {
                    // Close modal
                    $('#actionModal').modal('hide');
                    
                    // Show success message
                    CourierApp.showToast(actionSummary + '<br>' + actions.join('<br>'), 'success');
                    
                    // Optional: Refresh table to show updated data
                    // tableInstance.ajax.reload(); // Uncomment when using server-side data
                }, 500);
            };
            
            // Handle modal form submission with Enter key
            $('#actionModal').on('keypress', function(e) {
                if (e.which === 13) { // Enter key
                    e.preventDefault();
                    submitParcelAction();
                }
            });
            
            // Focus on reason field when modal opens
            $('#actionModal').on('shown.bs.modal', function() {
                $('#actionReason').focus();
            });
            
            console.log('Parcels page initialized successfully with enhanced DataTables controls');
        });
    </script>
</body>
</html>
