{%extends 'base.html'%}
{%block title%}<title>DeliverySoldier</title>{%endblock%}
{%block content%}
<!--**********************************
            Content body start
        ***********************************-->
        <div class="content-body">
            <div class="container-fluid">
                <div class="row page-titles mx-0">
                    <div class="col-sm-6 p-md-0">
                        <div class="welcome-text">
                            <h4>Riders Management</h4>
                            <span>Manage all delivery riders and their assignments</span>
                        </div>
                    </div>
                    <div class="col-sm-6 p-md-0 justify-content-sm-end mt-2 mt-sm-0 d-flex">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="javascript:void(0)">Home</a></li>
                            <li class="breadcrumb-item active"><a href="javascript:void(0)">Riders</a></li>
                        </ol>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="row mb-3">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-3 mb-2">
                                        <a href="add-rider.html" class="btn btn-primary btn-block">
                                            <i class="fas fa-bike mr-2"></i>Add New Rider
                                        </a>
                                    </div>
                                    <div class="col-md-3 mb-2">
                                        <a href="rider-assignments.html" class="btn btn-success btn-block">
                                            <i class="fas fa-tasks mr-2"></i>Assign Parcels
                                        </a>
                                    </div>
                                    <div class="col-md-3 mb-2">
                                        <a href="rider-tracking.html" class="btn btn-info btn-block">
                                            <i class="fas fa-map-marker-alt mr-2"></i>Track Riders
                                        </a>
                                    </div>
                                    <div class="col-md-3 mb-2">
                                        <a href="rider-performance.html" class="btn btn-warning btn-block">
                                            <i class="fas fa-chart-line mr-2"></i>Performance
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Statistics Cards -->
                <div class="row">
                    <div class="col-xl-3 col-lg-6 col-sm-6">
                        <div class="widget-stat card bg-primary">
                            <div class="card-body p-4">
                                <div class="media ai-icon">
                                    <span class="mr-3 ai-icon">
                                        <i class="fas fa-bike text-white"></i>
                                    </span>
                                    <div class="media-body">
                                        <h3 class="mb-0 text-white">{{total_soldiers}}</h3>
                                        <p class="mb-0 text-white">Total Riders</p>
                                        <small class="text-white-50">All registered riders</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-6 col-sm-6">
                        <div class="widget-stat card bg-success">
                            <div class="card-body p-4">
                                <div class="media ai-icon">
                                    <span class="mr-3 ai-icon">
                                        <i class="fas fa-check-circle text-white"></i>
                                    </span>
                                    <div class="media-body">
                                        <h3 class="mb-0 text-white">{{active_soldiers}}</h3>
                                        <p class="mb-0 text-white">Active Riders</p>
                                        <small class="text-white-50">Currently working</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-6 col-sm-6">
                        <div class="widget-stat card bg-warning">
                            <div class="card-body p-4">
                                <div class="media ai-icon">
                                    <span class="mr-3 ai-icon">
                                        <i class="fas fa-clock text-white"></i>
                                    </span>
                                    <div class="media-body">
                                        <h3 class="mb-0 text-white">{{off_duty}}</h3>
                                        <p class="mb-0 text-white">Off Duty</p>
                                        <small class="text-white-50">On leave or break</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-6 col-sm-6">
                        <div class="widget-stat card bg-info">
                            <div class="card-body p-4">
                                <div class="media ai-icon">
                                    <span class="mr-3 ai-icon">
                                        <i class="fas fa-shipping-fast text-white"></i>
                                    </span>
                                    <div class="media-body">
                                        <h3 class="mb-0 text-white">{{total_parcels}}</h3>
                                        <p class="mb-0 text-white">Parcels Assigned</p>
                                        <small class="text-white-50">Currently assigned</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Riders Table -->
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header bg-primary">
                                <h4 class="card-title text-white mb-0">All Riders</h4>
                                <div class="card-tools">
                                    <div class="input-group">
                                        <input type="text" class="form-control" placeholder="Search riders..." >
                                        <div class="input-group-append">
                                            <button class="btn btn-outline-light" type="button">
                                                <i class="fas fa-search"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table id="ridersTable" class="table table-striped table-bordered">
                                        <thead>
                                            <tr>
                                                <th>ID</th>
                                                <th>Photo</th>
                                                <th>Name</th>
                                                <th>Phone</th>
                                                <th>Vehicle</th>
                                                <th>Area</th>
                                                <th>Status</th>
                                                <th>Parcels</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {% for soldier in soldiers %}
                                            <tr>
                                                <td>{{soldier.soldiers_id}}</td>
                                                <td><img src="{{soldier.photo.url}}" width="40" height="40" class="rounded-circle"></td>
                                                <td>{{soldier.soldiers_name}}</td>
                                                <td>{{soldier.soldiers_phone}}</td>
                                                <td>{{soldier.soldiers_vehicle}}</td>
                                                <td>{{ soldier.soldiers_area_id }}</td>
                                                
                                                
                                                <td>
                                                     {% if soldier.status == "active" %}
                                                             <span class="badge badge-success">Active</span>
                                                     {% elif soldier.status == "off_duty" %}
                                                             <span class="badge badge-warning">Off Duty</span>
                                                     {% else %}
                                                             <span class="badge badge-danger">Suspended</span>
                                                    {% endif %}
                                                </td>
                                            
                                                <td>
                                                    {% for parcel in soldier.parcels.all %}
                                                      <span class="badge badge-info">{{ parcel.parcel_id }}</span>
                                                    {% empty %}
                                                          <span class="text-muted">No parcels</span>
                                                    {% endfor %}
                                                </td>
                                                <td>
                                                    <div class="dropdown">
                                                        <button class="btn btn-primary btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
                                                            Actions
                                                        </button>
                                                        <div class="dropdown-menu">
                                                            <a class="dropdown-item" href="{% url 'soldier_detail' soldier.soldiers_name %}"><i class="fas fa-eye mr-2"></i>View</a>
                                                            <a class="dropdown-item" href="{% url 'soldier_edit' soldier.soldiers_name %}"><i class="fas fa-edit mr-2"></i>Edit</a>
                                                            <a class="dropdown-item" href="rider-parcels.html"><i class="fas fa-box mr-2"></i>Parcels</a>
                                                            <a class="dropdown-item" href="track-rider.html"><i class="fas fa-map-marker-alt mr-2"></i>Track</a>
                                                            {% if soldier.status == "active" %}
                                                              <a class="dropdown-item text-warning" href="#"><i class="fas fa-pause mr-2"></i>Suspend</a>
                                                            {% elif soldier.status == "off_duty" %}
                                                              <a class="dropdown-item text-success" href="#"><i class="fas fa-play mr-2"></i>Activate</a>
                                                            {% endif %}
                                                              <a class="dropdown-item text-danger" href="#"><i class="fas fa-trash mr-2"></i>Delete</a>
                                                        </div>
                                                    </div>
                                                </td>
                                            </tr>
                                            {%endfor%}
                                            
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--**********************************
            Content body end
        ***********************************-->
{%endblock%}